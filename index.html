<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Tra cứu học sinh</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    input { padding: 8px; font-size: 16px; width: 300px; }
    button { padding: 8px 16px; }
    table { border-collapse: collapse; margin-top: 20px; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 10px; text-align: center; }
    img { max-width: 160px; }
    a { color: #0073aa; }
  </style>
</head>
<body>
  <h2>Tra cứu thông tin học sinh</h2>
  <input type="text" id="searchInput" placeholder="Nhập ID hoặc Tên học sinh">
  <button onclick="searchData()">Tìm kiếm</button>
  <div id="tableContainer"></div>

  <script>
    function searchData() {
      const keyword = document.getElementById("searchInput").value.trim();
      const url = "https://script.google.com/macros/s/AKfycbwvzUbOo9zBEkKkuwjXIlqlJ6jz9qiCIt-AVp9YFs6uJCMs2wBGBZsFicjNtbzffp6g/exec?keyword=" + encodeURIComponent(keyword);

      fetch(url)
        .then(res => res.json())
        .then(data => {
          if (!data || data.length === 0) {
            document.getElementById("tableContainer").innerHTML = "<p>Không tìm thấy học sinh</p>";
            return;
          }

          let table = "<table><thead><tr>";
          const headers = ["STT", "Họ tên", "Lớp", "Trường", "Mã ID", "QR"];
          headers.forEach(h => table += `<th>${h}</th>`);
          table += "</tr></thead><tbody>";

          data.forEach(row => {
            table += "<tr>";
            row.forEach((cell, index) => {
              if (index === 13 && cell.includes("http")) {
                const img = `<img src="${cell}" alt="QR">`;
                const link = `<a href="${cell}" target="_blank">Bấm vào đây</a>`;
                table += `<td>${img}<br>${link}</td>`;
              } else {
                table += `<td>${cell}</td>`;
              }
            });
            table += "</tr>";
          });

          table += "</tbody></table>";
          document.getElementById("tableContainer").innerHTML = table;
        });
    }
  </script>
</body>
</html>
